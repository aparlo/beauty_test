extends layout

block content
  .uk-container.uk-container-small
    form(id="send")
      input.inp.uk-input(id="inp" type="text")
      button.send.uk-button(type="submit") Submit
    #result
  button.get_result(type="button") Get Result

  script.
    var socket = io.connect();
    //- socket.on('connect', function(data) {
    //-   socket.emit('join', 'HeyHey');
    //- })
    //- socket.on('messages', function(data){
    //-   alert(data)
    //- })
    
    $(document).ready(function(){
      $("#inp").keyup(function(e){
        var text = $(this).val()
        console.log()
        $("#send").submit()
      })
    })
    
    
    $(document).ready(function(){
      $('#send').submit(function(e){
        e.preventDefault()
        var data = $(this).find("input").val()
        socket.emit('querry', data)
      })
    })

    $(".get_result").click(function(e){
      console.log('Rusult clicked')
      socket.emit('get_result', 1)
    })

    socket.on('result', function(data){
      $("#result").empty()
      if(data)
        $("#result").append("<ul>")
        jQuery.each(data, function(i, val){
          $("#result").append("<li>" + val.username + "</li>")
        })
       
    })